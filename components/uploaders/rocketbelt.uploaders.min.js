"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}!function(o,u,c){var r="uploader-dragged-on",f="uploader-max-files";function i(e){var t=void 0;return e.classList&&(t=e.classList.contains("uploader")?e:e.closest(".uploader")),t}function s(e){c("#"+i(e.target).id+' input[type="file"]').click()}function n(e){var t;(t=i(e.target))&&t.classList&&(t.classList&&t.classList.add("uploader-expanded"),t.removeAttribute(o.aria.role),t.removeAttribute("tabindex"),t.removeEventListener("click",s),t.removeEventListener("click",n))}function d(t){return o.uploaders.instances.filter(function(e){return e.config.id===t})[0]}function l(e){var t=d(i(e.target).id).config;t.isMobile&&n(e),o.uploaders.handleFiles(this.files,t.id)}function p(e){e.preventDefault(),e.stopPropagation()}function v(e){var t=c(e.target),a=t.hasClass(r)?t:t.closest(".uploader");a.hasClass(r)||(a.find(".scrim, .scrim_icon").css("z-index","1"),a.addClass(r))}function m(e){var t=c(e.target),a=t.hasClass(r)?t:t.closest(".uploader");a.hasClass(r)&&(a.removeClass(r),a.find(".scrim, .scrim_icon").css("z-index","-1"))}function b(e){var t=i(e.target);if(0<o.uploaders.numCanAdd(t.id)){var a=e.dataTransfer.files;o.uploaders.handleFiles(a,t.id)}}["dragenter","dragover","dragleave","drop"].forEach(function(e){u.body.addEventListener(e,p)}),o.uploaders=o.uploaders||{},o.uploaders.addUploader=function(e){var t=void 0;if(e&&e.selector){if((t=u.querySelector(e.selector)).id=t.id||"rb_"+o.getShortId(),e.id=t.id,e.isMobile=e.isMobile||t&&t.classList&&t.classList.contains("uploader-mobile")||0<u.querySelectorAll(".mobile .uploader, .tablet .uploader").length,t&&t.classList&&(e.isMobile&&(t.classList.add("uploader-mobile"),t.addEventListener("click",s)),t.classList.contains("uploader-expanded")||(t.setAttribute(o.aria.role,"button"),t.setAttribute("tabindex",0))),!e.isMobile){t.addEventListener("click",n),["dragenter","dragover","dragleave","drop"].forEach(function(e){t.addEventListener(e,p)}),["dragenter","dragover"].forEach(function(e){t.addEventListener(e,v)}),["dragleave","drop"].forEach(function(e){t.addEventListener(e,m)}),t.addEventListener("drop",b);var a=u.createElement("div");a.classList.add("scrim"),t.insertAdjacentElement("afterbegin",a);var r=u.createElement("div");r.classList.add("scrim_icon"),a.insertAdjacentElement("afterend",r)}o.uploaders.instances=o.uploaders.instances||[],o.uploaders.instances.push({config:e,files:[]}),c(t).find(".uploader_file-label").keydown(function(e){13!==e.which&&32!==e.which||c(e.target).click()});var i=c(t).find('input[type="file"]'),d=i[0].id||"rb_"+o.getShortId();i.attr("id",d),c(t).find(".uploader_file-label").attr("for",d).attr("aria-role","button").attr("tabindex",0),i.change(l)}return t.id},o.uploaders.getInstanceForId=d,o.uploaders.numCanAdd=function(e){var t=d(e),a=t.files?t.files.length:0;return(t.config.maxFiles||Number.POSITIVE_INFINITY)-a},o.uploaders.handleFiles=function(e,r){var t=o.uploaders.numCanAdd(r);[].concat(_toConsumableArray(e)).slice(0,t).forEach(function(e){var t,a,s,n,l;t=e,s=d(a=r),n=u.getElementById(a),(l=new FileReader).size=t.size,n.dispatchEvent(new CustomEvent("rb.uploaders.addingFile")),l.readAsDataURL(t),l.onloadend=function(){var e=s.config.filesAsBinary?o.dataURItoBlob(l.result):l.result,t=u.createElement("img");t.src=l.result,t.id="rb_"+o.getShortId(),t.classList.add("uploader_thumb");var a={id:t.id,file:e,size:l.size};s.files.push(a),n.dispatchEvent(new CustomEvent("rb.uploaders.fileAdded",{detail:a}));var r=u.createElement("button");r.dataset.targetId=t.id,r.classList.add("uploader_thumbs_remove-button"),r.innerHTML="&times;",r.setAttribute(o.aria.label,"Remove this image"),o.once(r,"click",function(e){var t=e.target.dataset.targetId,a=u.querySelector("#"+t),r=e.target.closest(".uploader");if(a.parentNode.removeChild(a),e.target.parentNode.removeChild(e.target),r&&0===r.querySelectorAll(".uploader_thumb").length&&r.classList.remove("uploader-has-thumbs"),s.files=s.files.filter(function(e){return e.id!==t}),0<o.uploaders.numCanAdd(n.id)){var i=c("#"+n.id);c("#"+n.id+" .uploader_file-input, #"+n.id+" .uploader_file-label").removeAttr("disabled"),i.removeClass(f)}var d={removedId:t};u.getElementById(n.id).dispatchEvent(new CustomEvent("rb.uploaders.fileRemoved",{detail:d}))}),u.querySelector("#"+n.id+" .uploader_thumbs").appendChild(t),u.querySelector("#"+t.id).insertAdjacentElement("afterend",r);var i=u.querySelector("#"+n.id);if(i&&i.classList.add("uploader-has-thumbs"),!o.uploaders.numCanAdd(n.id)){var d=c("#"+n.id);c("#"+n.id+" .uploader_file-input, #"+n.id+" .uploader_file-label").attr("disabled",""),d.addClass(f)}}})}}(window.rb,document,jQuery);
//# sourceMappingURL=rocketbelt.uploaders.min.js.map
