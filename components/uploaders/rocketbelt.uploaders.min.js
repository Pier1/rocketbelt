"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}!function(n,s,d){var r="uploader-dragged-on";function o(e){var t,r=e.target.classList.contains("uploader")?e.target:e.target.closest(".uploader");(t=r).classList.add("uploader-expanded"),t.removeAttribute(n.aria.role),t.removeAttribute("tabindex"),t.removeEventListener("click",o)}function i(e){n.uploaders.handleFiles(this.files,n.uploaders.config)}function l(e){e.preventDefault(),e.stopPropagation()}function u(e){var t=d(e.target).hasClass(r)?e.target:d(e.target).closest(".uploader");d(t).hasClass(r)||(d(t).find(".scrim, .scrim_icon").css("z-index","1"),d(t).addClass(r))}function c(e){var t=d(e.target).hasClass(r)?e.target:d(e.target).closest(".uploader");d(t).hasClass(r)&&(d(t).removeClass(r),d(t).find(".scrim, .scrim_icon").css("z-index","-1"))}function p(e){var t=e.dataTransfer.files;n.uploaders.handleFiles(t,n.uploaders.config)}["dragenter","dragover","dragleave","drop"].forEach(function(e){s.body.addEventListener(e,l)}),n.uploaders=n.uploaders||{},n.uploaders.addUploader=function(e){if(e&&e.selector){var t=s.querySelector(e.selector);if(t.id=t.id||"rb_"+n.getShortId(),e.id=t.id,t.classList.contains("uploader-expanded")||(t.setAttribute(n.aria.role,"button"),t.setAttribute("tabindex",0)),!t.classList.contains("uploader-mobile")){t.addEventListener("click",o),["dragenter","dragover","dragleave","drop"].forEach(function(e){t.addEventListener(e,l)}),["dragenter","dragover"].forEach(function(e){t.addEventListener(e,u)}),["dragleave","drop"].forEach(function(e){t.addEventListener(e,c)}),t.addEventListener("drop",p);var r=s.createElement("div");r.classList.add("scrim"),t.insertAdjacentElement("afterbegin",r);var a=s.createElement("div");a.classList.add("scrim_icon"),r.insertAdjacentElement("afterend",a)}n.uploaders.config=e,d(t).find(".uploader_file-label").keydown(function(e){13!==e.which&&32!==e.which||d(e.target).click()}),d(t).find('input[type="file"]').change(i)}};var a=[],f=s.querySelector(".uploader progress");function g(e,t){a[e]=t;var r=a.reduce(function(e,t){return e+t},0)/a.length;f.value=r}function t(e){n.uploaders.files=n.uploaders.files||[];var a=new FileReader;a.size=e.size,a.readAsDataURL(e),a.onloadend=function(){var e=s.createElement("img");e.src=a.result,e.id="rb_"+n.getShortId(),e.classList.add("uploader_thumb");var t={id:e.id,file:a.result,size:a.size};n.uploaders.files.push(t),s.getElementById(n.uploaders.config.id).dispatchEvent(new CustomEvent("rb.uploaders.fileAdded",{detail:t}));var r=s.createElement("button");r.dataset.targetId=e.id,r.classList.add("uploader_thumbs_remove-button"),r.innerHTML="&times;",r.setAttribute(n.aria.label,"Remove this image"),n.once(r,"click",function(e){var t=e.target.dataset.targetId,r=s.querySelector("#"+t),a=e.target.closest(".uploader");r.parentNode.removeChild(r),e.target.parentNode.removeChild(e.target),0===a.querySelectorAll(".uploader_thumb").length&&a.classList.remove("uploader-has-thumbs"),n.uploaders.files=n.uploaders.files.filter(function(e){return e.id!==t});var d={removedId:t};s.getElementById(n.uploaders.config.id).dispatchEvent(new CustomEvent("rb.uploaders.fileRemoved",{detail:d}))}),s.querySelector(".uploader_thumbs").appendChild(e),s.querySelector("#"+e.id).insertAdjacentElement("afterend",r),s.querySelector("#"+n.uploaders.config.id).classList.add("uploader-has-thumbs")}}function v(e,t){var r=new FormData,a=new XMLHttpRequest;r=n.uploaders.config.prepFormData(r),n.uploaders.config.prepXhr&&(a=n.uploaders.config.prepXhr(a)),a.open("POST",n.uploaders.config.postUri,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.upload.addEventListener("progress",function(e){g(t,100*e.loaded/e.total||100)}),a.addEventListener("readystatechange",function(e){4===a.readyState&&200===a.status?g(t,100):4===a.readyState&&a.status}),a.send(r)}n.uploaders.handleFiles=function(e){(function(e){f.value=0,a=[];for(var t=e;0<t;t--)a.push(0)})((e=[].concat(_toConsumableArray(e))).length),n.uploaders.config.autoUpload&&e.forEach(v),e.forEach(t)}}(window.rb,document,jQuery);
//# sourceMappingURL=rocketbelt.uploaders.min.js.map
