{"version":3,"sources":["components/forms/rocketbelt.forms.min.js"],"names":["rb","document","aria","affixInputs","$","each","$affixedInputs","this","$input","siblings","top","position","$affixment","css","decorateInputs","formEls","querySelectorAll","formElsLen","length","_loop","el","i","addEventListener","classList","add","onClassMutation","mutations","mutationsLen","k","mutation","target","querySelector","describedByErrorId","describedByIds","oldValue","contains","setAttribute","invalid","DESCRIBED_BY_ERROR_ID_ATTR","getAttribute","message","role","push","join","removeAttribute","live","splice","describedby","observe","observer","subtree","attributes","attributeOldValue","messages","parentNode","msgLen","hasAttribute","j","thisMsg","id","getShortId","trim","formsAndGroups","_loop2","checkValidity","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","err","return","onDocumentReady","forms","window"],"mappings":"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","file":"rocketbelt.forms.min.js","sourcesContent":["'use strict';\n((rb, document) => {\n  const aria = rb.aria;\n  const DESCRIBED_BY_ERROR_ID_ATTR = 'data-rb-describedbyerrorid';\n\n  function onClassMutation(mutations) {\n    const mutationsLen = mutations.length;\n\n    for (let k = 0; k < mutationsLen; k++) {\n      const mutation = mutations[k];\n      const el = mutation.target;\n      const message = el.parentNode.querySelector('.validation-message');\n\n      let describedByErrorId = '';\n      let describedByIds = [];\n      let i = -1;\n\n      if (mutation.oldValue !== 'invalid' && mutation.target && mutation.target.classList.contains('invalid')) {\n        // If \"invalid\" was added, do the decoratin'\n        el.setAttribute(aria.invalid, 'true');\n        describedByErrorId = el.getAttribute(DESCRIBED_BY_ERROR_ID_ATTR);\n        describedByIds = el.getAttribute(aria.describedby).split(' ');\n        i = describedByIds.indexOf(describedByErrorId);\n\n        if (message) {\n          message.setAttribute(aria.role, 'alert');\n          message.setAttribute(aria.live, 'polite');\n\n          // If a validation message exists && the related element is newly invalid,\n          // add message id to described-by\n          if (i === -1) {\n            describedByIds.push(describedByErrorId);\n            el.setAttribute(aria.describedby, describedByIds.join(' '));\n          }\n        }\n      } else if (mutation.oldValue === 'invalid' && el && !el.classList.contains('invalid')) {\n        // If \"invalid\" was removed\n        el.setAttribute(aria.invalid, 'false');\n        describedByErrorId = el.getAttribute(DESCRIBED_BY_ERROR_ID_ATTR);\n        describedByIds = el.getAttribute(aria.describedby).split(' ');\n        i = describedByIds.indexOf(describedByErrorId);\n\n        if (message) {\n          message.removeAttribute('role');\n          message.removeAttribute(aria.live);\n\n          // If a validation message exists && the related element longer invalid,\n          // remove message id from described-by\n          if (i > -1) {\n            describedByIds.splice(i, 1);\n            el.setAttribute(aria.describedby, describedByIds.join(' '));\n          }\n        }\n      }\n    }\n  }\n\n  function affixInputs() {\n    const $affixedInputs = $('input.affixed');\n\n    $affixedInputs.each(function () {\n      const $input = $(this);\n      const $affixment = $input.siblings('.affixment');\n\n      const top = $input.position().top;\n\n      $affixment.css('top', top);\n      $affixment.addClass('affixed');\n    });\n  }\n\n  function decorateInputs() {\n    const formEls = document.querySelectorAll(\n      '.form-group input, .form-group select, .form-group textarea, .form-group fieldset'\n    );\n    const formElsLen = formEls.length;\n\n    for (let i = 0; i < formElsLen; i++) {\n      const el = formEls[i];\n\n      // \"invalid\" will be raised by the checkValidity() call below.\n      // .invalid is added and will be handled by the MutationObserver\n      // created by this function.\n      // https://daverupert.com/2017/11/happier-html5-forms/\n      el.addEventListener('invalid', () => {\n        if (el && el.classList) {\n          el.classList.add('invalid');\n        }\n      }, false);\n\n      // Set an observer to listen for .invalid.\n      const observer = new MutationObserver(mutations => { onClassMutation(mutations); });\n      observer.observe(el, {\n        subtree: false,\n        attributes: true,\n        attributeOldValue: true,\n        attributeFilter: ['class']\n      });\n\n      const messages = el.parentNode.querySelectorAll('.validation-message, .helper-text');\n      const msgLen = messages.length;\n\n      if (msgLen > 0) {\n        let describedByIds = '';\n\n        if (el.hasAttribute(aria.describedby)) {\n          describedByIds = `${el.getAttribute(aria.describedby)} `;\n        }\n\n        for (let j = 0; j < msgLen; j++) {\n          const thisMsg = messages[j];\n          const id = thisMsg.id ? thisMsg.id : `rb-a11y_${rb.getShortId()}`;\n          describedByIds += `${id} `;\n\n          if (thisMsg.classList.contains('validation-message')) {\n            el.setAttribute(DESCRIBED_BY_ERROR_ID_ATTR, id);\n          }\n\n          // Don't clobber any existing attributes!\n          if (!thisMsg.id) {\n            thisMsg.id = id;\n          }\n        }\n\n        if (!el.hasAttribute(aria.describedby)) {\n          el.setAttribute(aria.describedby, describedByIds.trim());\n        }\n      }\n    }\n\n    const formsAndGroups =\n      document.querySelectorAll('form.validate-on-blur, .form-group.validate-on-blur');\n    for (const el of formsAndGroups) {\n      el.addEventListener('blur', () => {\n        el.checkValidity();\n      });\n    }\n  }\n\n  rb.onDocumentReady(decorateInputs);\n  rb.onDocumentReady(affixInputs);\n  rb.forms = rb.forms || {};\n  rb.forms.decorateInputs = decorateInputs;\n  rb.forms.affixInputs = affixInputs;\n})(window.rb, document);\n"],"sourceRoot":"../.."}