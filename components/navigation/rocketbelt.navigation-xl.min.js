!function(D,y,u){"use strict";var E,l,I,k,c,s,a,o,r,f,d,h,b,m,i,N,p,n="accessibleMegaMenu",g={uuidPrefix:"accessible-megamenu",menuClass:"accessible-megamenu",topNavItemClass:"accessible-megamenu-top-nav-item",panelClass:"accessible-megamenu-panel",panelGroupClass:"accessible-megamenu-panel-group",hoverClass:"hover",focusClass:"focus",openClass:"open"},w={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,keyMap:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",190:"."}};function t(e,t){this.element=e,this.settings=D.extend({},g,t),this._defaults=g,this._name=n,this.init()}function C(e){return D.expr.filters.visible(e)&&!D(e).parents().addBack().filter(function(){return"hidden"===D.css(this,"visibility")}).length}function v(e,t){var s,a,i,n=e.nodeName.toLowerCase();return"area"===n?(a=(s=e.parentNode).name,!(!e.href||!a||"map"!==s.nodeName.toLowerCase())&&(!!(i=D("img[usemap=#"+a+"]")[0])&&C(i))):(/input|select|textarea|button|object/.test(n)?!e.disabled:"a"===n&&e.href||t)&&C(e)}t.prototype=(i=0,N="",p=!!y.hasOwnProperty("ontouchstart"),E=function(e){return D(e).closest(":data(plugin_"+n+")").data("plugin_"+n)},l=function(e){e=D(e);var t=this.settings;e.attr("id")||e.attr("id",t.uuidPrefix+"-"+(new Date).getTime()+"-"+ ++i)},I=function(e,t){var s,a=D(e.target),i=this,n=this.settings,l=this.menu,o=a.closest("."+n.topNavItemClass),r=a.hasClass(n.panelClass)?a:a.closest("."+n.panelClass);if(m.call(this,t),D("html").off("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu, pointerup.outside-accessible-megamenu",c),l.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.accessible-megamenu"),t)if((o=l.find("."+n.topNavItemClass+" ."+n.openClass+":first").closest("."+n.topNavItemClass)).is(e.relatedTarget)||0<o.has(e.relatedTarget).length)0===o.length&&l.find("[aria-expanded=true]").attr("aria-expanded","false").removeClass(n.openClass).filter("."+n.panelClass).attr("aria-hidden","true");else{if(("mouseout"===e.type||"focusout"===e.type)&&0<o.has(u.activeElement).length)return;o.removeClass(n.openClass),o.find("[aria-expanded]").attr("aria-expanded","false").removeClass(n.openClass).filter("."+n.panelClass).attr("aria-hidden","true"),("keydown"===e.type&&e.keyCode===w.ESCAPE||"DOMAttrModified"===e.type)&&(s=o.find(":tabbable:first"),setTimeout(function(){l.find("[aria-expanded]."+i.settings.panelClass).off("DOMAttrModified.accessible-megamenu"),s.focus(),i.justFocused=!1},99))}else clearTimeout(i.focusTimeoutID),o.addClass(n.openClass),o.siblings().removeClass(n.openClass).find("[aria-expanded]").attr("aria-expanded","false").removeClass(n.openClass).filter("."+n.panelClass).attr("aria-hidden","true"),o.find("[aria-expanded]").attr("aria-expanded","true").addClass(n.openClass).filter("."+n.panelClass).attr("aria-hidden","false"),"mouseover"===e.type&&a.is(":tabbable")&&1===o.length&&0===r.length&&0<l.has(u.activeElement).length&&(a.focus(),i.justFocused=!1),m.call(i)},k=function(e){var t=D(e.target),s=t.closest("."+this.settings.topNavItemClass),a=t.hasClass("closer"),i=t.closest("."+this.settings.menuClass),n=t.closest("."+this.settings.panelClass);if(i.data("is-scrolling"))return i.data("is-scrolling",!1),void e.preventDefault();if(1===s.length&&0===n.length&&1===s.find("."+this.settings.panelClass).length)t.hasClass(this.settings.openClass)||(e.preventDefault(),e.stopPropagation(),I.call(this,e));else if(a)return I.call(this,e,!0),!1},c=function(e){0===this.menu.has(D(e.target)).length&&I.call(this,e,!0)},b=function(e){D(e.target).data("is-scrolling",!0)},s=function(e){"aria-expanded"===e.originalEvent.attrName&&"false"===e.originalEvent.newValue&&D(e.target).hasClass(this.settings.openClass)&&(e.preventDefault(),e.stopPropagation(),I.call(this,e,!0))},a=function(e){var t=D(e.target);if(t.hasClass("closer"))return!0;clearTimeout(this.focusTimeoutID),t.addClass(this.settings.focusClass),this.justFocused=!0,this.panels.filter("."+this.settings.openClass).length&&I.call(this,e)},o=function(t){this.justFocused=!1;var s=this,e=D(t.target),a=e.closest("."+this.settings.topNavItemClass);e.removeClass(this.settings.focusClass).off("click.accessible-megamenu",k),y.cvox?s.focusTimeoutID=setTimeout(function(){y.cvox.Api.getCurrentNode(function(e){a.has(e).length?clearTimeout(s.focusTimeoutID):s.focusTimeoutID=setTimeout(function(e,t,s){I.call(e,t,s)},275,s,t,!0)})},25):s.focusTimeoutID=setTimeout(function(){I.call(s,t,!0)},300)},r=function(e){var t,s,a,i,n,l,o=D(D(this).is(".hover:tabbable")?this:e.target),r=o.is(e.target)?this:E(o),u=r.settings,c=r.menu,f=r.topnavitems,d=o.closest("."+u.topNavItemClass),h=c.find(":tabbable"),b=o.hasClass(u.panelClass)?o:o.closest("."+u.panelClass),m=b.find("."+u.panelGroupClass),p=o.closest("."+u.panelGroupClass),g=o.hasClass("closer"),C=e.keyCode||e.which,v=!1,x=w.keyMap[e.keyCode]||"",T=1===d.length&&0===b.length;switch(o.is(".hover:tabbable")&&D("html").off("keydown.accessible-megamenu"),C){case w.ESCAPE:I.call(r,e,!0);break;case w.DOWN:e.preventDefault(),T?(I.call(r,e),v=1===d.find("."+u.panelClass+" :tabbable:first").focus().length):v=1===h.filter(":gt("+h.index(o)+"):first").focus().length,!v&&y.opera&&"[object Opera]"===opera.toString()&&(e.ctrlKey||e.metaKey)&&(a=(h=D(":tabbable")).index(o),v=1===D(":tabbable:gt("+D(":tabbable").index(o)+"):first").focus().length);break;case w.UP:e.preventDefault(),T&&o.hasClass(u.openClass)?(I.call(r,e,!0),(t=f.filter(":lt("+f.index(d)+"):last")).children("."+u.panelClass).length&&(v=1===t.children().attr("aria-expanded","true").addClass(u.openClass).filter("."+u.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):T||(v=1===h.filter(":lt("+h.index(o)+"):last").focus().length),!v&&y.opera&&"[object Opera]"===opera.toString()&&(e.ctrlKey||e.metaKey)&&(a=(h=D(":tabbable")).index(o),v=1===D(":tabbable:lt("+D(":tabbable").index(o)+"):first").focus().length);break;case w.RIGHT:e.preventDefault(),T?v=1===f.filter(":gt("+f.index(d)+"):first").find(":tabbable:first").focus().length:(m.length&&p.length&&(v=1===m.filter(":gt("+m.index(p)+"):first").find(":tabbable:first").focus().length),v||(v=1===d.find(":tabbable:first").focus().length));break;case w.LEFT:e.preventDefault(),T?v=1===f.filter(":lt("+f.index(d)+"):last").find(":tabbable:first").focus().length:(m.length&&p.length&&(v=1===m.filter(":lt("+m.index(p)+"):last").find(":tabbable:first").focus().length),v||(v=1===d.find(":tabbable:first").focus().length));break;case w.TAB:a=h.index(o),e.shiftKey&&T&&o.hasClass(u.openClass)?(I.call(r,e,!0),(t=f.filter(":lt("+f.index(d)+"):last")).children("."+u.panelClass).length&&(v=t.children().attr("aria-expanded","true").addClass(u.openClass).filter("."+u.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):e.shiftKey&&0<a?v=1===h.filter(":lt("+a+"):last").focus().length:!e.shiftKey&&a<h.length-1?v=1===h.filter(":gt("+a+"):first").focus().length:y.opera&&"[object Opera]"===opera.toString()&&(a=(h=D(":tabbable")).index(o),v=e.shiftKey?1===D(":tabbable:lt("+D(":tabbable").index(o)+"):last").focus().length:1===D(":tabbable:gt("+D(":tabbable").index(o)+"):first").focus().length),v&&e.preventDefault();break;case w.SPACE:T&&(e.preventDefault(),k.call(r,e));break;case w.ENTER:if(g){I.call(r,e,!0);break}default:if(clearTimeout(this.keydownTimeoutID),0===(N+=x!==N?x:"").length)return;for(this.keydownTimeoutID=setTimeout(function(){N=""},1e3),h=T&&!o.hasClass(u.openClass)?h.filter("."+u.topNavItemClass+" > :tabbable"):d.find(":tabbable"),e.shiftKey&&(h=D(h.get().reverse())),a=0;a<h.length;a++)if((i=h.eq(a)).is(o)){s=1===N.length?a+1:a;break}for(l=new RegExp("^"+N.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),"i"),a=s;a<h.length;a++)if(i=h.eq(a),n=D.trim(i.text()),l.test(n)){v=!0,i.focus();break}if(!v)for(a=0;a<s;a++)if(i=h.eq(a),n=D.trim(i.text()),l.test(n)){i.focus();break}}r.justFocused=!1},f=function(e){this.mouseDownTimeoutID=setTimeout(function(){clearTimeout(this.focusTimeoutID)},1)},d=function(e){var t=this;clearTimeout(this.mouseOutTimeoutID),clearTimeout(this.mouseDownTimeoutID),D(e.target).addClass(this.settings.hoverClass),t.mouseOverTimeoutID=setTimeout(function(){I.call(t,e)},250)},h=function(e){var t=this;clearTimeout(this.mouseOverTimeoutID),D(e.target).removeClass(t.settings.hoverClass),t.mouseOutTimeoutID=setTimeout(function(){I.call(t,e,!0)},250)},m=function(e){var t=this.menu;e?(D("html").off("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu",c),t.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.accessible-megamenu",s)):(D("html").on("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu",c.bind(this)),t.find("[aria-expanded=true]."+this.settings.panelClass).on("DOMAttrModified.accessible-megamenu",s.bind(this)))},{constructor:t,init:function(){var i=this,n=this.settings,e=(this.justFocused=!1,this.nav=D(this.element)),t=this.menu=e.children().first(),s=this.topnavitems=t.children();e.attr("role","navigation"),t.addClass(n.menuClass),s.each(function(e,t){var s,a;(t=D(t)).addClass(n.topNavItemClass),s=t.find(":tabbable:first"),a=t.children(":not(:tabbable):last"),l.call(i,s),a.length&&(l.call(i,a),s.attr({"aria-haspopup":!0,"aria-owns":a.attr("id"),"aria-controls":a.attr("id"),"aria-expanded":!1}),a.attr({role:"group","aria-expanded":!1,"aria-hidden":!0}).addClass(n.panelClass).not("[aria-labelledby]").attr("aria-labelledby",s.attr("id")))}),this.panels=t.find("."+n.panelClass),t.on("focusin.accessible-megamenu",":tabbable, :focusable, ."+n.panelClass,a.bind(this)).on("focusout.accessible-megamenu",":tabbable, :focusable, ."+n.panelClass,o.bind(this)).on("keydown.accessible-megamenu",r.bind(this)).on("mouseover.accessible-megamenu",d.bind(this)).on("mouseout.accessible-megamenu",h.bind(this)).on("mousedown.accessible-megamenu",f.bind(this)),p?(t.on("touchend.accessible-megamenu",k.bind(this)),t.on("scroll.accessible-megamenu",b)):t.on("click.accessible-megamenu",k.bind(this)),t.find("hr").attr("role","separator")},getDefaults:function(){return this._defaults},getOption:function(e){return this.settings[e]},getAllOptions:function(){return this.settings},setOption:function(e,t,s){this.settings[e]=t,s&&this.init()}}),D.fn[n]=function(e){return this.each(function(){D.data(this,"plugin_"+n)||D.data(this,"plugin_"+n,new t(this,e))})},D.extend(D.expr[":"],{data:D.expr.createPseudo?D.expr.createPseudo(function(t){return function(e){return!!D.data(e,t)}}):function(e,t,s){return!!D.data(e,s[3])},focusable:function(e){return v(e,!isNaN(D.attr(e,"tabindex")))},tabbable:function(e){var t=D.attr(e,"tabindex"),s=isNaN(t);return(s||0<=t)&&v(e,!s)}}),D(y).on("load resize",function(){for(var e=D(".sub-nav"),t=0;t<e.length;t++)D(e[t]).height()>D(y).height()&&D(e[t]).css({height:"80vh","overflow-y":"scroll"})})}(jQuery,window,document);
//# sourceMappingURL=rocketbelt.navigation-xl.min.js.map
